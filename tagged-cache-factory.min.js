!function(a,b){"function"==typeof define&&define.amd?define(["angular"],b):a.taggedCacheFactory=b(a.angular)}(this,function(a){"use strict";var b=a.module("tagged.services.cache-factory",[]);return b.factory("taggedCacheFactory",["$cacheFactory",function(){var b=function(b,c){this._cache={},this._head=null,this._tail=null,this._options=a.extend({capacity:!1},c||{})};b.prototype.get=function(a){if(!this._cache.hasOwnProperty(a))return void 0;var b=this._cache[a];if(b.expiration){var d=new Date;if(d.getTime()>b.expiration.getTime())return this.remove(a),void 0}return c.call(this,b),b.value},b.prototype.put=function(a,b,f){var g={key:a,value:b,expiration:!1};f=parseInt(f,10),isFinite(f)&&f>0&&(g.expiration=new Date((new Date).getTime()+f)),c.call(this,g),this._cache[a]=g,this._options.capacity>0&&Object.keys(this._cache).length>this._options.capacity&&(e.call(this),Object.keys(this._cache).length>this._options.capacity&&d.call(this))};var c=function(a){this._head?(a.next=this._head,this._head.previous=a):a.next=null,a.previous=null,this._head=a,this._tail||(this._tail=a)},d=function(){if(this._head===this._tail)return console.log("nothing to do, head === tail"),void 0;var a=this._tail,b=a.previous;b.next=null,this._tail=b,delete this._cache[a.key]},e=function(){var b=new Date,c=this;a.forEach(this._cache,function(a,d){a.expiration&&b.getTime()>a.expiration.getTime()&&c.remove(d)})};b.prototype.remove=function(a){this._cache.hasOwnProperty(a)&&delete this._cache[a]},b.prototype.removeAll=function(){this._cache={},this._head=null,this._tail=null};var f=function(a,c){return new b(a,c)};return f.TaggedCache=b,f}]),b});